<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<link rel="stylesheet" href="https://tools-static.wmflabs.org/cdnjs/ajax/libs/leaflet/1.3.1/leaflet.css">
		<link rel="stylesheet" href="{{config.STATIC_URL}}stylesheet.css">
		<link rel="stylesheet" href="{{config.STATIC_URL}}MarkerCluster/MarkerCluster.css">
		<link rel="stylesheet" href="{{config.STATIC_URL}}MarkerCluster/MarkerCluster.Default.css">
		<title>{{ locale["title"] }}</title>
	</head>
	<body>
		<div class="navbar">
			<h1 class="navbar-brand">{{ locale["title"] }}</h1>
			<img src="{{config.STATIC_URL}}wmcz.png" class="navbar-logo">
		</div>

		<div class="container">
			<form>
				<div class="row">
					<div class="col-6">
						<label for="startswith">{{ locale["search-startswith"] }}: </label><input type="text" id="startswith" name="startswith" value="{{ startswith }}"><br />
					</div>
					<div class="col-6">
						<label for="contains">{{ locale["search-contains"] }}: </label><input type="text" id="contains" name="contains" value="{{ contains }}"><br />
					</div>
				</div>

				<input class="btn btn-primary btn-block" type="submit" value="{{ locale['search'] }}" />
			</form>
			<div id="map"></div>

		</div>

		<footer>
			<p>
				<a href="https://gerrit.wikimedia.org/r/p/labs/tools/map-of-monuments">{{ locale['source-code' ]}}</a> â€¢
				<a href="https://phabricator.wikimedia.org/maniphest/task/edit/form/1/?project=map-of-monuments">{{ locale['report-a-bug'] }}</a></p>
		</footer>

		<script src="https://tools-static.wmflabs.org/cdnjs/ajax/libs/jquery/3.3.1/jquery.min.js" charset="utf-8"></script>
		<script src="https://tools-static.wmflabs.org/cdnjs/ajax/libs/leaflet/1.3.1/leaflet.js"></script>
		<script src="{{config.STATIC_URL}}MarkerCluster/leaflet.markercluster-src.js"></script>
		<script src="get_monuments?startswith={{ startswith }}&contains={{ contains }}"></script>
		<script>
			var style = 'osm-intl';
			var server = 'https://maps.wikimedia.org/';

			// Create a map
			var map = L.map('map');
			map.setView([50, 16], 7);
			L.tileLayer(server + style + '/{z}/{x}/{y}.png', {
						maxZoom: 18,
						id: 'wikipedia-map-01',
						attribution: '{{ locale["map-copyright"]|safe }}'
			}).addTo(map);
			
			var markers = L.markerClusterGroup();
			for (var i = 0; i < addressPoints.length; i++) {
				var a = addressPoints[i];
				var title = a[2];
				var marker = L.marker(new L.LatLng(a[0], a[1]), { title: title });
				marker.bindPopup(title);
				markers.addLayer(marker);
			}
			map.addLayer(markers);
		</script>
	</body>
</html>
